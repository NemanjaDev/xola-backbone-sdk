!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("backbone"),require("underscore")):"function"==typeof define&&define.amd?define(["backbone","underscore"],t):"object"==typeof exports?exports.XolaBackboneSDK=t(require("backbone"),require("underscore")):e.XolaBackboneSDK=t(e.Backbone,e._)}(this,function(e,t){return function(e){function t(n){if(o[n])return o[n].exports;var r=o[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var o={};return t.m=e,t.c=o,t.i=function(e){return e},t.d=function(e,o,n){t.o(e,o)||Object.defineProperty(e,o,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var o=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(o,"a",o),o},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=12)}([function(e,t,o){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.BaseModel=void 0;var r=o(8),i=n(r),l=o(2),u=n(l);t.BaseModel=u.default.Model.extend({parent:null,parentUrlRoot:null,initialize:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.parent,o=void 0===t?null:t;this.parent=o},url:function(e){var t=this.parent?this.parent.url(this.parentUrlRoot):"",o=void 0;if(e)if(this.isNew())o=e;else{var n=this.get(this.idAttribute);o=e.replace(/[^\/]$/,"$&/")+encodeURIComponent(n)}else o=u.default.Model.prototype.url.apply(this);return t+o},parse:function(e){var t=this,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e?(i.default.each(e,function(n,r){var i=n;t.constructor.PARSERS&&t.constructor.PARSERS[r]&&(i=t.constructor.PARSERS[r](n,o,t),i instanceof u.default.Model&&t.has(r)&&t.get(r).id==i.id&&(t.get(r).set(i.attributes),i=t.get(r)),i instanceof u.default.Collection&&t.has(r)&&(t.get(r).set(i.models),i=t.get(r))),e[r]=i}),e):e}})},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BaseCollection=void 0;var n=o(2),r=function(e){return e&&e.__esModule?e:{default:e}}(n),i=o(0);t.BaseCollection=r.default.Collection.extend({model:i.BaseModel,initialize:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.parent,o=void 0===t?null:t;this.parent=o},url:function(){return(this.parent?this.parent.url():"")+this.model.prototype.urlRoot},parse:function(e){return e.hasOwnProperty("paging")&&e.hasOwnProperty("data")?e.data:e},get:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=r.default.Collection.prototype.get.apply(this,[e]);if(!o&&t){var n={};n[this.model.idAttribute]=e,o=new this.model(n),this.add(o)}return o}},{buildModelPropertyComparator:function(e){return function(t){return t.get(e)}}})},function(t,o){t.exports=e},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={};t.CollectionPool={getCollection:function(e){if(!e.hasOwnProperty("POOL_ID"))throw new Error(e+" is not a valid Collection");return n.hasOwnProperty(e.POOL_ID)||(n[e.POOL_ID]=new e),n[e.POOL_ID]}}},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExperienceCollection=void 0;var n=o(1),r=o(6);t.ExperienceCollection=n.BaseCollection.extend({model:r.Experience},{POOL_ID:"Experiences"})},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Event=void 0;var n=o(0),r=o(7),i=o(4);t.Event=n.BaseModel.extend({urlRoot:"/events"},{PARSERS:{start_date:r.ParseHelper.Date,experience:r.ParseHelper.Model(i.ExperienceCollection)}})},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Experience=void 0;var n=o(0);t.Experience=n.BaseModel.extend({urlRoot:"/experiences"})},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ParseHelper=void 0;var n=o(0),r=o(1),i=o(3);t.ParseHelper={Date:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){return new Date(e)}),Locale:function(e){return e.replace("_","-")},Model:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e.prototype instanceof r.BaseCollection?function(t,o){var n=e.prototype.model.prototype.idAttribute,r=i.CollectionPool.getCollection(e).get(t[n],!0);return r.set(r.parse(t,o),o),r}:e.prototype instanceof n.BaseModel?function(o,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return t&&r&&(o.parent=r),new e(o,{parse:!0})}:void 0},Collection:function(e){return function(t,o){return new e(o)}}}},function(e,o){e.exports=t},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EventCollection=void 0;var n=o(1),r=o(5);t.EventCollection=n.BaseCollection.extend({model:r.Event},{POOL_ID:"Events"})},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Seller=void 0;var n=o(0);t.Seller=n.BaseModel.extend({urlRoot:"/sellers"})},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.User=void 0;var n=o(8),r=function(e){return e&&e.__esModule?e:{default:e}}(n),i=o(0),l=o(7),u=o(13),a={ROLE_SELLER:"ROLE_SELLER",ROLE_SUPER_ADMIN:"ROLE_SUPER_ADMIN",ROLE_ADMIN:"ROLE_ADMIN",ROLE_RESERVATION:"ROLE_RESERVATION",ROLE_RESERVATION_LITE:"ROLE_RESERVATION_LITE",ROLE_GUIDE_MANAGER:"ROLE_GUIDE_MANAGER"},s=t.User=i.BaseModel.extend({urlRoot:"/users",hasRole:function(e){return r.default.contains(this.get("roles"),e)},isSeller:function(){return this.hasRole(a.ROLE_SELLER)},isAdmin:function(){return this.hasRole(s.ROLE_ADMIN)||this.hasRole(s.ROLE_SUPER_ADMIN)},isReservationist:function(){return this.hasRole(s.ROLE_RESERVATION)||this.hasRole(s.ROLE_RESERVATION_LITE)},isGuideManager:function(){return this.hasRole(s.ROLE_GUIDE_MANAGER)}},{ROLE_SELLER:"ROLE_SELLER",ROLE_SUPER_ADMIN:"ROLE_SUPER_ADMIN",ROLE_ADMIN:"ROLE_ADMIN",ROLE_RESERVATION:"ROLE_RESERVATION",ROLE_RESERVATION_LITE:"ROLE_RESERVATION_LITE",ROLE_GUIDE_MANAGER:"ROLE_GUIDE_MANAGER",PARSERS:{locale:l.ParseHelper.Locale,meta:l.ParseHelper.Model(u.Meta)}})},function(e,t,o){"use strict";var n,r=o(2),i=function(e){return e&&e.__esModule?e:{default:e}}(r),l=o(0),u=o(1),a=o(6),s=o(5),c=o(10),d=o(11),f=o(4),E=o(9),p=o(3),R={BaseModel:l.BaseModel,BaseCollection:u.BaseCollection,Model:{Experience:a.Experience,Event:s.Event,Seller:c.Seller,User:d.User},Collection:{Experiences:f.ExperienceCollection,Events:E.EventCollection},CollectionPool:p.CollectionPool,setBaseUrl:function(e){i.default.$.ajaxSetup({beforeSend:function(t,o){o.url=e+o.url,o.crossDomain=!0}})},setApiKey:function(e){var t=i.default.$.ajaxSetup().headers||{};e?t["X-API-KEY"]=e:delete t["X-API-KEY"],i.default.$.ajaxSetup(i.default.$.ajaxSettings,{headers:t})},login:function(e,t){var o=this,n=i.default.$.ajaxSetup().headers||{};n.Authorization="Basic "+btoa(e+":"+t),delete n["X-API-KEY"],i.default.$.ajaxSetup(i.default.$.ajaxSettings,{headers:n}),i.default.$.ajax({url:"/users/me/apiKey",success:function(e){o.setApiKey(e[0])}})},logout:function(){this.setApiKey()}};n||(R.setBaseUrl("http://xola.local/api"),console.log("Initializing SDK"),n=!0),e.exports=R},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Meta=void 0;var n=o(0);t.Meta=n.BaseModel.extend({urlRoot:"/meta"})}])});